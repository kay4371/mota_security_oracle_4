

<!DOCTYPE html>
<html lang="en">

<head>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script> 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

	<meta charset="UTF-8">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
	<link rel="stylesheet"
		href="https://rawcdn.githack.com/Loopple/loopple-public-assets/ad60f16c8a16d1dcad75e176c00d7f9e69320cd4/argon-dashboard/css/nucleo/css/nucleo.css">
	<link rel="stylesheet" href="styles.css">
	<link rel="stylesheet" href="./assets_for access_control/css/theme.css">
	<link rel="stylesheet" href="./assets_for access_control/css/style3.css">

	<body>
		<div class="container">

			<!-- <div id="realtimeUpdates"></div> -->
			<!-- Column for All Updates -->
			<div class="column">
				<h2>All Updates</h2>
				<ul id="allUpdates"></ul> 
				
			</div>
	
			<div id="flash-notification" class="flash-notification">
				You have a new message
			</div>
			<ul id="realtimeUpdates"></ul>
			</div>
		</div>

	<style>
        /* Define your CSS styles here */
        .container {
            display: flex;
            justify-content: space-between;
        }

        .column {
            width: 48%; /* Adjust the width as needed */
            border: 1px solid #ccc;
            padding: 10px;
            margin: 5px;
            overflow-y: scroll; /* Add scroll if content overflows */
            max-height: 400px; /* Add a maximum height if needed */
        }
    </style>



 <style>
	/* Styling for the button */
	.styled-button {
	  background-color: #3498db; /* Blue color */
	  color: #fff; /* White text color */
	  border: none;
	  border-radius: 5px; /* Curved edges */
	  padding: 10px 20px;
	  cursor: pointer;
	  transition: background-color 0.3s, transform 0.3s; /* Add a transition for a subtle animation */
	}
	
	/* Hover effect - Lighten the background color on hover */
	.styled-button:hover {
	  background-color: #2980b9; /* Slightly darker blue */
	}
	
	/* Click effect - Scale down the button on click */
	.styled-button:active {
	  transform: scale(0.95);
	}
	</style>


	<style>

/* Add this CSS code to your stylesheet */


.share-button {
  transition: background-color 0.3s ease, color 0.3s ease; /* Add a transition effect for background-color and text color */
}

.share-button:hover {
  background-color: #4CAF50; /* Change the background color on hover */
  color: #fff; /* Change the text color on hover */
}

.share-button:active {
  transform: scale(0.95); /* Add a scaling effect when the button is clicked */
}

/* Add this CSS code to your stylesheet */

.preview-button {
  transition: background-color 0.3s ease, color 0.3s ease; /* Add a transition effect for background-color and text color */
}

.preview-button:hover {
  background-color: #4CAF50; /* Change the background color on hover */
  color: #fff; /* Change the text color on hover */
}

.preview-button:active {
  transform: scale(0.95); /* Add a scaling effect when the button is clicked */
}



		.tab-content {
			display: none;
		}

		.table-container {
			margin-top: 20px;
		}

		.table-container table {
			width: 100%;
			border-collapse: collapse;
		}

		.table-container th,
		.table-container td {
			padding: 10px;
			border: 1px solid #ccc;
		}

		.table-container th {
			background-color: #f2f2f2;
		}

		.access-buttons {
			display: flex;
			justify-content: center;
			margin-top: 10px;
		}

		.grant-access {
			background-color: #5cb85c;
			color: white;
		}

		.deny-access {
			background-color: #d9534f;
			color: white;
		}

		.history-container {
			margin-top: 20px;
		}

		.history-container table {
			width: 100%;
			border-collapse: collapse;
		}

		.history-container th,
		.history-container td {
			padding: 10px;
			border: 1px solid #ccc;
		}

		.history-container th {
			background-color: #f2f2f2;
		}
	</style>


<style>

/* You can add additional styles to the button as needed */

	/* Your CSS styles here */
	.overlay {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.7);
		display: flex;
		justify-content: center;
		align-items: center;
		z-index: 9999;
	}

	.gate-pass-content {
		background-color: white;
		padding: 20px;
		border-radius: 5px;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
		text-align: center;
	}

	.close-button {
		background-color: #ccc;
		color: #333;
		border: none;
		padding: 5px 10px;
		border-radius: 3px;
		cursor: pointer;
	}

	.close-button:hover {
		background-color: #999;
		color: #fff;
	}

/* Define a CSS animation for left and right motion */
@keyframes bell-motion {
    0% { transform: translateX(0); }
    50% { transform: translateX(-10px); }
    100% { transform: translateX(0); }
}

/* Apply the animation to the bell icon */
.bell-icon-animation {
    animation: bell-motion 1s ease infinite;
}

/* Define a CSS class to change the color of the bell icon to green */
.bell-icon {
    color: rgb(white) !important;
}

.green-bell {
            color: rgb(9, 255, 0) !important; /* Use !important to override other styles if necessary */
        }
</style>
<style>
body2 {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
#loader {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 3px solid transparent;
  border-radius: 50%;
  border-top: 3px solid #058ed9;
  border-bottom: 3px solid #f9627d;
  animation: load 3s ease-in-out infinite alternate;
}

@keyframes load {
  0% {
    transform: translate(-50%, -50%) rotatez(0deg);
  }
  100% {
    transform: translate(-50%, -50%) rotatez(540deg);
  }
}

</style>

</head>
  
  
<body class="g-sidenav-show">


<script>
	function sharePDFViaEmail() {
	  const loaders = document.querySelectorAll("#loader");
	
	  loaders.forEach((loader, index) => {
		loader.style.width = `${(index + 1) * 30}px`;
		loader.style.height = `${(index + 1) * 30}px`;
		loader.style.animationDelay = `${index * 75}ms`;
	  });
	
	  // Start animation when email is loading
	  const loadingAnimation = setInterval(() => {
		loaders.forEach((loader, index) => {
		  loader.style.animationPlayState = "running";
		});
	  }, 100);
	
	  // Simulate email loading for 2 seconds (you can adjust this duration)
	  setTimeout(() => {
		clearInterval(loadingAnimation); // Stop the animation
		sendEmail(); // Send the email
	  }, 2000); // Adjust the delay as needed
	
	  function sendEmail() {
		const subject = 'Gate Pass';
		const body = 'Please find the gate pass attached.';
		const email = 'recipient@example.com'; // Replace with the recipient's email address
		const pdfFileName = 'gate_pass.pdf'; // Replace with the PDF file name
	
		const emailLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(
		  body
		)}&attachment=${encodeURIComponent(pdfFileName)}`;
		window.location.href = emailLink;
	  }
	}
	
	
	
	function sharePDFViaWhatsApp() {
	  // Generate the PDF from the gate pass content using downloadGatePassAsPDF()
	
	  // After generating the PDF, you can share it via WhatsApp
	  const message = 'Please find the gate pass attached.';
	  const pdfFileName = 'gate_pass.pdf'; // Replace with the PDF file name
	
	  // You can create a link to the PDF file and share it via WhatsApp
	  const pdfLink = `https://example.com/path-to-pdf/${pdfFileName}`; // Replace with the actual link
	  const whatsappMessage = `${message}%0A%0A${pdfLink}`;
	
	  const whatsappLink = `https://api.whatsapp.com/send?text=${encodeURIComponent(whatsappMessage)}`;
	  window.open(whatsappLink, '_blank');
	}
	
	 window.addEventListener('load', function() {
		fetch('/get_visitor_counts')
		   .then(response => response.json())
		   .then(data => {
			  const { todayCount, weekCount, totalCount } = data;
	 
			  const visitorCountsPlaceholder = document.getElementById('visitorCountsPlaceholder');
			  visitorCountsPlaceholder.textContent = `${todayCount}/${weekCount}`;
			  
			  const totalVisitorCount = document.getElementById('totalVisitorCount');
			  totalVisitorCount.textContent = totalCount;
		   })
		   .catch(error => {
			  console.error('Error fetching visitor counts:', error);
		   });
	 });
	 
	 // For movement counts
	 window.addEventListener('load', function () {
		fetch('/get_movements_counts')
		   .then(response => response.json())
		   .then(data => {
			  const { todayCount, weekCount, totalCount } = data;
	 
			  const movementCountsSpan = document.getElementById('movementCountsPlaceholder');
			  movementCountsSpan.textContent = `${todayCount}/${weekCount}`;
	 
			  const totalMovementCount = document.getElementById('totalMovementCount');
			  totalMovementCount.textContent = totalCount;
		   })
		   .catch(error => {
			  console.error('Error fetching movement counts:', error);
		   });
	 });
	</script>
	
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				const bellIcon = document.getElementById('bellIcon');
				const triggerButton = document.getElementById('triggerButton');
	


					// Function to play alert sound
					function playAlertSound() {
					// Replace this path with the correct path to your sound file
					const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
					alertSound.play();
					}




				// Function to turn the bell icon green, play alert sound, and start animation
				function triggerAnimationAndAlert() {
					// Add the green color class
					bellIcon.classList.add('green-bell');
	
					// // Play alert sound (replace with your own sound file)
					// // const alertSound = new Audio('path/to/alert-sound.mp3');
					// const alertSound = new Audio('C:\Users\Administrator\OneDrive\Desktop\Development tools\playground\backupVisitor-Movement Management\Visitor-Movement Management4\public\assets\sound\water_droplet_5-165635.mp3');
					// alertSound.play();
	
					// Start the animation
					bellIcon.classList.add('bell-icon-animation');
					 // Play the alert sound
					 playAlertSound();
				}
	
				// Add a click event listener to the trigger button
				triggerButton.addEventListener('click', triggerAnimationAndAlert);
			});
		</script>



	<nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-white loopple-fixed-start"
		id="sidenav-main">
		<div class="sidenav-header  align-items-center">
			<a class="navbar-brand" href="javascript:void(0)">
				<img src="assets/Mota-Engil.svg.png">

				<!-- <img src="https://demos.creative-tim.com/argon-dashboard/assets-old/img/brand/blue.png" class="navbar-brand-img" alt="..."> -->
			</a>
		</div>


		<div class="navbar-inner">
			<div class="collapse navbar-collapse" id="sidenav-collapse-main">
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link active" href="javascript:">
							<i class="fas fa-desktop text-primary"></i>
							<span class="nav-link-text">Movement Manager M.E</span>
						</a>
					</li>

					<div id="visitorCounts"></div>

					<li class="nav-item">
						<a class="nav-link" onclick="showTab(2)" href="javascript:">
							<i class="fas fa-exchange-alt text-danger"></i>
							<span class="nav-link-text">Movements</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" onclick="showTab(0)" href="javascript:">
							<i class="fas fa-users text-danger"></i>
							<span class="nav-link-text">Visitors</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" onclick="showTab(1)" href="javascript:">
							<i class="fas fa-history text-danger"></i>
							<span class="nav-link-text">Visits History</span>
						</a>
					</li>

					<!-- <li class="nav-item"id="fetchButton">
						<a class="nav-link" onclick="showTab(3)" href="javascript:">
							<i class="fas fa-history text-danger"></i>
							<span class="nav-link-text">Movements History</span>
						</a>
					</li>  -->
					<a class="nav-link" id="fetchButton" href="javascript:">
						<i class="fas fa-history text-danger"></i>
						<span class="nav-link-text">Movements History</span>
					</a>


					
					<li class="nav-item">
						<a class="nav-link" href="javascript:" onclick="showFormPage('newVisitorLink')">
							<i class="fas fa-history text-danger"></i>
							<span class="nav-link-text">New Movements</span>
						</a>
					</li>
					<!-- <li class="nav-item">
						<a class="nav-link" href="javascript:" onclick="showFormPage('directoryManagerLink')">
							<i class="fas fa-history text-danger"></i>
							<span class="nav-link-text">Directory Manager</span>
						</a>
					</li> -->
					<li class="nav-item">
						<a class="nav-link" href="directory_options.html">
							<i class="fas fa-history text-danger"></i>
							<span class="nav-link-text">Directory Manager</span>
						</a>
					</li>
					
				</ul>
			</div>
		</div>
	</nav>


	<div class="main-content" id="panel">
		<nav class="navbar navbar-top navbar-expand navbar-dark border-bottom bg-dark" id="navbarTop">
			<div class="container-fluid">
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<form class="navbar-search navbar-search-light form-inline mr-sm-3 mb-0" id="navbar-search-main">
						<div class="form-group mb-0">
							<div class="input-group input-group-alternative input-group-merge">
								<div class="input-group-prepend">
									<span class="input-group-text"><i class="fas fa-search"></i></span>
								</div>
								<input class="form-control" placeholder="Search" type="text">
							</div>
						</div>
						<button type="button" class="close" data-action="search-close" data-target="#navbar-search-main"
							aria-label="Close">
							<span aria-hidden="true">Ã—</span>
						</button>
					</form>


					<ul class="navbar-nav align-items-center  ml-md-auto ">
						<li class="nav-item d-xl-none">
							<div class="pr-3 sidenav-toggler sidenav-toggler-dark active" data-action="sidenav-pin"
								data-target="#sidenav-main">
								<div class="sidenav-toggler-inner">
									<i class="sidenav-toggler-line"></i>
									<i class="sidenav-toggler-line"></i>
									<i class="sidenav-toggler-line"></i>
								</div>
							</div>
						</li>
						<li class="nav-item d-sm-none">
							<a class="nav-link" href="#" data-action="search-show" data-target="#navbar-search-main">
								<i class="ni ni-zoom-split-in"></i>
							</a>
						</li>

				
<!-- 
							<li class="nav-item dropdown">
								<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
									aria-expanded="false">
									<i class="fa fa-bell red-bell" id="bellIcon"></i>
							</a>
							
					
								<div class="dropdown-menu dropdown-menu-xl dropdown-menu-right py-0 overflow-hidden" id="notificationDropdown">
							
									<div class="px-3 py-3">
										<h6 class="text-sm text-muted m-0">You have <strong class="text-primary" id="notificationCount">0</strong> notifications.</h6>

									</div>
									<div class="list-group list-group-flush">
								
									</div>
									<a href="#!" class="dropdown-item text-center text-primary font-weight-bold py-3">Most Recent Updates
										</a>
								</div> -->





								<li class="nav-item dropdown">
									<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
										aria-expanded="false">
										<i class="fa fa-bell red-bell" id="bellIcon"></i>
									</a>
								
								
								
									<div class="dropdown-menu dropdown-menu-xl dropdown-menu-right py-0 overflow-hidden" id="notificationDropdown">
										<!-- Existing dropdown content -->
									  <!-- </div>
									  
									<div class="dropdown-menu dropdown-menu-xl  dropdown-menu-right  py-0 overflow-hidden"> -->
										<div class="px-3 py-3">
											<h6 class="text-sm text-muted m-0">You have <strong class="text-primary" id="notificationCount">0</strong> notifications.</h6>
											<!-- <h6 class="text-sm text-muted m-0">You have <strong class="text-primary">13</strong> -->
												<!-- notifications.</h6> -->
										</div>
										<div class="list-group list-group-flush">
									
										</div>
										<a href="#!" class="dropdown-item text-center text-primary font-weight-bold py-3">Most Recent Updates
											</a>
									</div>





							</li>
							<li class="nav-item dropdown">
								<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
									aria-expanded="false">
									<!-- <i class="fa fa-layer-group"></i> 
									 <i class="fas fa-layer-group" id="layerGroupIcon" style="display: none;"></i> -->
									<!-- <i class="fas fa-star" id="starIcon"></i>  -->
									<i class="fas fa-layer-group" id="layerGroupIcon" style="color: rgb(74, 216, 8);"></i>
									<i class="fas fa-star" id="starIcon" style="color: transparent; display: none;"></i>
								</a>
								<div
									class="dropdown-menu dropdown-menu-lg dropdown-menu-dark bg-default  dropdown-menu-right ">
									<div class="row shortcuts px-4">
									</div>
								</div>
							</li>
						</ul>




					<ul class="navbar-nav align-items-center  ml-auto ml-md-0 ">
						<li class="nav-item dropdown">
							<a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false">
								<div class="media align-items-center">
									<span class="avatar avatar-sm rounded-circle">
										<img alt="Image placeholder"
											src="https://demos.creative-tim.com/argon-dashboard/assets-old/img/theme/team-4.jpg">
									</span>
									<div class="media-body  ml-2  d-none d-lg-block">
										<span class="mb-0 text-sm  font-weight-bold">User </span>
									</div>
								</div>
							</a>
					
						</li>
					</ul>
				</div>
			</div>
		</nav>







		<div class="container-fluid pt-3">
			<div class="row removable">
				<div class="col-xl-3 col-md-6">
					<div class="card bg-gradient-primary border-0" onclick="showTab(0)">
						<!-- Card body -->
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0 text-white">Visitors</h5>

									<span class="h2 font-weight-bold mb-0 text-white" id="visitorCountsPlaceholder">Loading...</span>
								

									<div class="progress progress-xs mt-3 mb-0">
										<div class="progress-bar bg-success" role="progressbar" aria-valuenow="30"
											aria-valuemin="0" aria-valuemax="100" style="width: 30%;"></div>
									</div>
								</div>
								<div class="col-auto">
									<button type="button" class="btn btn-sm btn-neutral mr-0" data-toggle="dropdown"
										aria-haspopup="true" aria-expanded="false">
										<i class="fas fa-ellipsis-h"></i>
									</button>
									<div class="dropdown-menu dropdown-menu-right">
										<a class="dropdown-item" href="#">Expected Visitors</a>
										<a class="dropdown-item" href="#">History</a>
										<a class="dropdown-item" href="#">Something else here</a>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-sm">
								<a href="#!" class="text-nowrap text-white font-weight-600">See details</a>
							</p>
						</div>
					</div>
				</div>
			
				<div class="col-xl-3 col-md-6">
					<!-- <div class="card bg-gradient-info border-0" onclick="showTab(2)"></div> -->
					<div class="card bg-gradient-info border-0" onclick="showTab(8)"> 
						<!-- Card body -->
						<div class="card-body d-flex flex-column justify-content-between"> <!-- Apply flexbox styles here -->
							<h5 class="card-title text-uppercase text-muted mb-0 text-white">Nothing Here!</h5>
							<span class="h2 font-weight-bold mb-0 text-white" id="movementCountsPlaceholder">Loading...</span>
							<div class="progress progress-xs mt-3 mb-0">
								<div class="progress-bar bg-success" role="progressbar" aria-valuenow="50"
									aria-valuemin="0" aria-valuemax="100" style="width: 50%;"></div>
							</div>
							<p class="mt-3 mb-0 text-sm">
								<a href="#!" class="text-nowrap text-white font-weight-600">See details</a>
							</p>
						</div>
					</div>
				</div>
				
				<div class="col-xl-3 col-md-6">
					<div class="card bg-gradient-danger border-0"  onclick="showFormPage()">
					  <div class="card-body" >
						<div class="row">
						  <div class="col">
							<h5 class="card-title text-uppercase text-muted mb-0 text-white">New Movements</h5>
							<span class="h2 font-weight-bold mb-0 text-white">200/300</span>
							<div class="progress progress-xs mt-3 mb-0">
							  <div class="progress-bar bg-success" role="progressbar" aria-valuenow="80"
								aria-valuemin="0" aria-valuemax="100" style="width: 80%;"></div>
							</div>
						  </div>
						  <div class="col-auto">
							<button type="button" class="btn btn-sm btn-neutral mr-0" data-toggle="dropdown"
							  aria-haspopup="true" aria-expanded="false" onclick="showFormAndTable()">
							  <i class="fas fa-ellipsis-h"></i>
							</button>
							<div class="dropdown-menu dropdown-menu-right">
							  <a class="dropdown-item" href="#">Action</a>
							  <a class="dropdown-item" href="#">Another action</a>
							  <a class="dropdown-item" href="#">Something else here</a>
							</div>
						  </div>
						</div>
						<p class="mt-3 mb-0 text-sm">
						  <a href="#!" class="text-nowrap text-white font-weight-600">See details</a>
						</p>
					  </div>
					</div>
				  </div>
				  
				 


				<div class="col-xl-3 col-md-6">
					<!-- <div class="card bg-gradient-default border-0" onclick="showTab(2)"> -->
						<div class="card bg-gradient-default border-0">
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0 text-white">Notifications</h5>
									<span class="h2 font-weight-bold mb-0 text-white">50/62</span>
									<div class="progress progress-xs mt-3 mb-0">
										<div class="progress-bar bg-success" role="progressbar" aria-valuenow="90"
											aria-valuemin="0" aria-valuemax="100" style="width: 90%;"></div>
									</div>
								</div>
								<div class="col-auto">
									<button type="button" class="btn btn-sm btn-neutral mr-0" data-toggle="dropdown"
										aria-haspopup="true" aria-expanded="false">
										<i class="fas fa-ellipsis-h"></i>
									</button>
									<div class="dropdown-menu dropdown-menu-right">
										<a class="dropdown-item" href="#">Action</a>
										<a class="dropdown-item" href="#">Another action</a>
										<a class="dropdown-item" href="#">Something else here</a>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-sm">
								<a href="#!" class="text-nowrap text-white font-weight-600">See details</a>
							</p>
						</div>
					</div>
				</div>
			</div>



			<div class="row removable">
				<div class="col-xl-3 col-md-6">
					<div class="card card-stats" onclick="showTab(1)">
						<!-- Card body -->
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0">Visits History.</h5>
									<span class="h2 font-weight-bold mb-0" id="totalVisitorCount">Loading...</span>

								</div>
								<div class="col-auto">
									<div class="icon icon-shape bg-gradient-red text-white rounded-circle shadow">
										<i class="fa fa-user"></i>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-sm">
								<span class="text-success mr-2">
									<i class="fa fa-arrow-up"></i> 3.48% </span>
								<span class="text-nowrap">Since last month</span>
							</p>
						</div>
					</div>
				</div>

				
				<div class="col-xl-3 col-md-6">
					<div class="card card-stats" style="height: 82%;">
						<button class="card-body card-stats-button" id="movementHistoryButton" style="border: none; background-color: transparent; padding: 0; cursor: pointer;">
							<div class="row align-items-start" style="align-items: center; margin-left: 10px;">
								<div class="col" style="text-align: left;">
									<h5 class="card-title text-uppercase text-muted mb-0" style="font-size: 0.8rem; margin-bottom: 0; vertical-align: top;">Movement History</h5>
									<span class="h2 font-weight-bold mb-0" id="totalMovementCount" style="font-size: 1rem; margin-top: 5px;">Loading...</span>
									<p class="mt-1 mb-0 text-sm" style="display: inline-block; text-align: left; margin-top: 3px; margin-bottom: 0;">
										<span class="text-success mr-1" style="font-size: 1rem;">
											<i class="fa fa-arrow-up"></i> 3.48% </span>
										<span class="text-nowrap" style="font-size: 0.875rem;">Since last month</span>
									</p>
								</div>
								<div class="col-auto">
									<div class="icon icon-shape bg-gradient-orange text-white rounded-circle shadow">
										<i class="fa fa-chart-pie"></i>
									</div>
								</div>
							</div>
						</button>
					</div>
				</div>
	



					<div class="col-xl-3 col-md-6">
						<a href="directory_options.html" style="text-decoration: none; color: inherit;">
							<div class="card card-stats">
								<div class="card-body">
									<div class="row">
										<div class="col">
											<h5 class="card-title text-uppercase text-muted mb-0">Directory Manager</h5>
											<span class="h2 font-weight-bold mb-0">2,356</span>
										</div>
										<div class="col-auto">
											<div class="icon icon-shape bg-gradient-orange text-white rounded-circle shadow">
												<i class="fa fa-chart-pie"></i>
											</div>
										</div>
									</div>
									<p class="mt-3 mb-0 text-sm">
										<span class="text-success mr-2">
											<i class="fa fa-arrow-up"></i> 3.48% 
										</span>
										<span class="text-nowrap">Since last month</span>
									</p>
								</div>
							</div>
						</a>
					</div>

				<div class="col-xl-3 col-md-6">
					<div class="card card-stats">

						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0">Statistics</h5>
									<span class="h2 font-weight-bold mb-0">2,356</span>
								</div>
								<div class="col-auto">
									<div class="icon icon-shape bg-gradient-orange text-white rounded-circle shadow">
										<i class="fa fa-chart-pie"></i>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-sm">
								<span class="text-success mr-2">
									<i class="fa fa-arrow-up"></i> 3.48% </span>
								<span class="text-nowrap">Since last month</span>
							</p>
						</div>
					</div>
				</div> 

				<div class="tab-content" id="tab1Content">
					<h2>Visits Details</h2>

				<!-- Add this HTML element to display the gate pass -->
					<div id="gatePassOverlay" style="display: none;">
						<!-- Your gate pass content here -->
					</div>
	
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>Name</th>
									<th>Whom to See</th>
									<th>Address / Company</th>
									<th>Purpose of Visit</th>
									<th>Phone Number</th>
									<th>Date</th>
									<th>Time</th>
									<th>Access</th>
								</tr>
							</thead>
							<tbody id="visitorTableBody1"></tbody>
						</table>
					</div>
				</div>

				<div class="tab-content" id="tab2Content">
					<h2>Visits History</h2>
					<div class="table-container">
						<table>
							<thead>
									<tr>
										<th>Name</th>
										<th>Whom to See</th>
										<th>Address / Company</th>
										<th>Purpose of Visit</th>
										<th>Phone Number</th>
										<th>Access</th>
										<th>Date</th>
									</tr>
							</thead>
							<tbody id="visitorTableBody2"></tbody>
						</table>
					</div>
				</div>

				<div class="tab-content" id="tab3Content">
					<h2>Movement Details</h2>
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th style="text-align: left;">Driver's Name</th>
									<th style="text-align: left;">Armed Guard</th>
									<th style="text-align: left;">Time Out</th>
									<th style="text-align: left;">Time In</th>
									<th style="text-align: left;">Destination</th>
									<th style="text-align: left;">Passenger</th>
									<th style="text-align: left;">Gate Pass</th>
								</tr>
							</thead>
							<tbody id="driverTableBody"></tbody>
						</table>
					</div>
				</div>
			</div>


			<div class="tab-content" id="tab4Content">
				<h2>Movements History</h2>
				<div class="table-container">
					<table>
						<thead>
							<tr>
								<th>Driver's Name</th>
								<th>Armed Guard</th>
								<th>Time Out</th>
								<th>Time In</th>
								<th>Destination</th>
								<th>Passenger</th>
							</tr>
						</thead>
						<tbody id="movementHistoryTableBody"></tbody>
					</table>
				</div>
			</div>

			<button id="triggerButton" class="styled-button">Back Home</button>




			
				<style>

					.tab-content table {
						width: 100%;
						table-layout: fixed;
					}

					.tab-content th {
						background: linear-gradient(to bottom, #003399, #66ccff);
						color: white;
					}

					.tab-content td,
					.tab-content th {
						padding: 8px;
						border: 1px solid #ddd;
						text-align: left;
					}

					.preview-button,
					.print-button,
					.share-button {
						display: block;
						width: 100%;
						padding: 6px 12px;
						border: none;
						border-radius: 4px;
						margin-bottom: 5px;
						cursor: pointer;
					}

					.preview-button {
						background-color: #5cb85c;
						color: white;
					}

					.print-button {
						background-color: #337ab7;
						color: white;
					}

					.share-button {
						background-color: #d9534f;
						color: white;
					}
				</style>


<script>
	// Get references to the icons and button
	const layerGroupIcon = document.getElementById('layerGroupIcon');
	const starIcon = document.getElementById('starIcon');
	const triggerButton = document.getElementById('triggerButton');
  
	// Add a click event listener to the button
	triggerButton.addEventListener('click', () => {
	  // Change the color of the layer icon to red
	  layerGroupIcon.style.color = 'red';
  
	  // Make the star icon green and visible
	  starIcon.style.color = 'green';
	  starIcon.style.display = 'inline'; // Set display to inline for visibility
  
	  // You can add additional animation or alerts here
	//   alert('Animation triggered!');
	});
  </script>




<!-- <script>
	const flashNotification = document.getElementById('flash-notification');
	const realtimeUpdatesList = document.getElementById('realtimeUpdates');
	const eventSource = new EventSource('/events');
	const notificationDropdown = document.getElementById('notificationDropdown'); // Dropdown container
  
	// Function to trigger the animation and alert
	function triggerAnimationAndAlert() {
	  const bellIcon = document.getElementById('bellIcon');
  
	  // Remove the 'red-bell' class and add the 'green-bell' class
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.add('green-bell');
  
	  // Play the alert sound (replace with your own sound file)
	  const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
	  alertSound.play();
  
	  // Start the animation
	  bellIcon.classList.add('bell-icon-animation');


// Event listener for the bell icon click
		document.getElementById('bellIcon').addEventListener('click', () => {
	  // Reset the bell icon to its green state and stop the animation
	  const bellIcon = document.getElementById('bellIcon');
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.remove('bell-icon-animation');
	  bellIcon.classList.remove('green-bell');
	  bellIcon.classList.add(' red-bell');
	
	});
	}
  
	eventSource.onmessage = (event) => {
	  console.log('Received data:', event.data); // Debugging line
  
	  // Trigger the animation and alert
	  triggerAnimationAndAlert();
  
	  // Display the flash notification when data is received
	  flashNotification.style.display = 'block';
  
	  // Hide the flash notification after a delay (e.g., 3 seconds)
	  setTimeout(() => {
		flashNotification.style.display = 'none';
	  }, 3000);
	//   notificationDropdown.innerHTML = '';
	  // Display the received data in the list
	  const newEntry = JSON.parse(event.data);
	  const listItem = document.createElement('li');
	  listItem.textContent = `Driver Name: ${newEntry.driver_name}, Passenger: ${newEntry.passenger}, Time Out: ${newEntry.time_out}`;
	  realtimeUpdatesList.appendChild(listItem);
  
	  // Create a new list item for the dropdown menu
	  const dropdownItem = document.createElement('a');
	  dropdownItem.classList.add('list-group-item', 'list-group-item-action');
	  dropdownItem.innerHTML = `
		<div class="row align-items-center">
		  <div class="col-auto">
			<img alt="Image placeholder" src="${newEntry.imageSrc || 'default-image.jpg'}" class="avatar rounded-circle">
		  </div>
		  <div class="col ml--2">
			<div class="d-flex justify-content-between align-items-center">
			  <div>
				<h4 class="mb-0 text-sm">${newEntry.driver_name|| 'Anonymous'}</h4>
			  </div>
			  <div class="text-right text-muted">
				<small>${newEntry.time_out}|| 'New Movement'}</small>
			  </div>
			</div>
		
		  </div>
		</div>
	  `;

	  // Add the new list item to the dropdown menu
	  notificationDropdown.appendChild(dropdownItem);
  
	  // Optionally, you can limit the number of notifications displayed by removing the oldest ones
	  const maxNotifications = 10; // Adjust this number as needed
	  if (notificationDropdown.children.length > maxNotifications) {
		notificationDropdown.removeChild(notificationDropdown.firstElementChild);
	  }

	const notificationCountElement = document.getElementById('notificationCount');
    // const notificationCount = notificationDropdown.children.length;
	const notificationCount = notificationDropdown.children.length - 3; // Subtract 3
    notificationCountElement.textContent = notificationCount;
	};
  </script> -->


  <!-- <script>
	document.addEventListener('DOMContentLoaded', function () {
		const bellIcon = document.getElementById('bellIcon');
	
		// Function to show an alert when the bell icon is clicked
		function showAlertOnClick() {
			alert('Bell icon was clicked!'); // Replace this with the alert message you want
		}
	
		// Add a click event listener to the bell icon
		bellIcon.addEventListener('click', showAlertOnClick);
	});
	</script> -->









<script>
document.addEventListener('DOMContentLoaded', function () {
    const bellIcon = document.getElementById('bellIcon');
	const flashNotification = document.getElementById('flash-notification');
	const realtimeUpdatesList = document.getElementById('realtimeUpdates');
	const eventSource = new EventSource('/events');
	const notificationDropdown = document.getElementById('notificationDropdown'); // Dropdown container

    // Function to show an alert when the bell icon is clicked
    function showAlertOnClick() {
		const bellIcon = document.getElementById('bellIcon');
        alert('Bell icon was clicked!'); // Replace this with the alert message you want
		 // Remove the 'red-bell' class and add the 'green-bell' class
		 bellIcon.classList.remove('red-bell');
	  bellIcon.classList.add('green-bell');
  
	  // Play the alert sound (replace with your own sound file)
	  const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
	  alertSound.play();
  
	  // Start the animation
	  bellIcon.classList.add('bell-icon-animation');


// Event listener for the bell icon click
		document.getElementById('bellIcon').addEventListener('click', () => {

		
	  // Reset the bell icon to its green state and stop the animation
	  const bellIcon = document.getElementById('bellIcon');
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.remove('bell-icon-animation');
	  bellIcon.classList.remove('green-bell');
	  bellIcon.classList.add(' red-bell');
	
	});
	}
  
	eventSource.onmessage = (event) => {
	  console.log('Received data:', event.data); // Debugging line
  
	  // Trigger the animation and alert
	  triggerAnimationAndAlert();
  
	  // Display the flash notification when data is received
	  flashNotification.style.display = 'block';
  
	  // Hide the flash notification after a delay (e.g., 3 seconds)
	  setTimeout(() => {
		flashNotification.style.display = 'none';
	  }, 3000);
	//   notificationDropdown.innerHTML = '';
	  // Display the received data in the list
	  const newEntry = JSON.parse(event.data);
	  const listItem = document.createElement('li');
	  listItem.textContent = `Driver Name: ${newEntry.driver_name}, Passenger: ${newEntry.passenger}, Time Out: ${newEntry.time_out}`;
	  realtimeUpdatesList.appendChild(listItem);
  
	  // Create a new list item for the dropdown menu
	  const dropdownItem = document.createElement('a');
	  dropdownItem.classList.add('list-group-item', 'list-group-item-action');
	  dropdownItem.innerHTML = `
		<div class="row align-items-center">
		  <div class="col-auto">
			<img alt="Image placeholder" src="${newEntry.imageSrc || 'default-image.jpg'}" class="avatar rounded-circle">
		  </div>
		  <div class="col ml--2">
			<div class="d-flex justify-content-between align-items-center">
			  <div>
				<h4 class="mb-0 text-sm">${newEntry.driver_name|| 'Anonymous'}</h4>
			  </div>
			  <div class="text-right text-muted">
				<small>${newEntry.time_out}|| 'New Movement'}</small>
			  </div>
			</div>
		
		  </div>
		</div>
	  `;

	  // Add the new list item to the dropdown menu
	  notificationDropdown.appendChild(dropdownItem);
  
	  // Optionally, you can limit the number of notifications displayed by removing the oldest ones
	  const maxNotifications = 10; // Adjust this number as needed
	  if (notificationDropdown.children.length > maxNotifications) {
		notificationDropdown.removeChild(notificationDropdown.firstElementChild);
	  }

	const notificationCountElement = document.getElementById('notificationCount');
    // const notificationCount = notificationDropdown.children.length;
	const notificationCount = notificationDropdown.children.length - 3; // Subtract 3
    notificationCountElement.textContent = notificationCount;
	};
    

    // Add a click event listener to the bell icon
    bellIcon.addEventListener('click', showAlertOnClick);
});
</script>




  <!-- <script>
	const flashNotification = document.getElementById('flash-notification');
	const realtimeUpdatesList = document.getElementById('realtimeUpdates');
	const eventSource = new EventSource('/events');
	const notificationDropdown = document.getElementById('notificationDropdown'); // Dropdown container
  
	// Function to trigger the animation and alert
	function triggerAnimationAndAlert() {
	const bellIcon = document.getElementById('bellIcon');
	alert("What is up")
	
	  

	  // Remove the 'red-bell' class and add the 'green-bell' class
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.add('green-bell');
  
	  // Play the alert sound (replace with your own sound file)
	  const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
	  alertSound.play();
  
	  // Start the animation
	  bellIcon.classList.add('bell-icon-animation');


// Event listener for the bell icon click
		document.getElementById('bellIcon').addEventListener('click', () => {

		
	  // Reset the bell icon to its green state and stop the animation
	  const bellIcon = document.getElementById('bellIcon');
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.remove('bell-icon-animation');
	  bellIcon.classList.remove('green-bell');
	  bellIcon.classList.add(' red-bell');
	
	});
	}
  
	eventSource.onmessage = (event) => {
	  console.log('Received data:', event.data); // Debugging line
  
	  // Trigger the animation and alert
	  triggerAnimationAndAlert();
  
	  // Display the flash notification when data is received
	  flashNotification.style.display = 'block';
  
	  // Hide the flash notification after a delay (e.g., 3 seconds)
	  setTimeout(() => {
		flashNotification.style.display = 'none';
	  }, 3000);
	//   notificationDropdown.innerHTML = '';
	  // Display the received data in the list
	  const newEntry = JSON.parse(event.data);
	  const listItem = document.createElement('li');
	  listItem.textContent = `Driver Name: ${newEntry.driver_name}, Passenger: ${newEntry.passenger}, Time Out: ${newEntry.time_out}`;
	  realtimeUpdatesList.appendChild(listItem);
  
	  // Create a new list item for the dropdown menu
	  const dropdownItem = document.createElement('a');
	  dropdownItem.classList.add('list-group-item', 'list-group-item-action');
	  dropdownItem.innerHTML = `
		<div class="row align-items-center">
		  <div class="col-auto">
			<img alt="Image placeholder" src="${newEntry.imageSrc || 'default-image.jpg'}" class="avatar rounded-circle">
		  </div>
		  <div class="col ml--2">
			<div class="d-flex justify-content-between align-items-center">
			  <div>
				<h4 class="mb-0 text-sm">${newEntry.driver_name|| 'Anonymous'}</h4>
			  </div>
			  <div class="text-right text-muted">
				<small>${newEntry.time_out}|| 'New Movement'}</small>
			  </div>
			</div>
		
		  </div>
		</div>
	  `;

	  // Add the new list item to the dropdown menu
	  notificationDropdown.appendChild(dropdownItem);
  
	  // Optionally, you can limit the number of notifications displayed by removing the oldest ones
	  const maxNotifications = 10; // Adjust this number as needed
	  if (notificationDropdown.children.length > maxNotifications) {
		notificationDropdown.removeChild(notificationDropdown.firstElementChild);
	  }

	const notificationCountElement = document.getElementById('notificationCount');
    // const notificationCount = notificationDropdown.children.length;
	const notificationCount = notificationDropdown.children.length - 3; // Subtract 3
    notificationCountElement.textContent = notificationCount;
	};
  </script> -->




  <!-- <script>
	document.addEventListener('DOMContentLoaded', function () {
	const flashNotification = document.getElementById('flash-notification');
	const realtimeUpdatesList = document.getElementById('realtimeUpdates');
	const eventSource = new EventSource('/events');
	const notificationDropdown = document.getElementById('notificationDropdown'); // Dropdown container
  
	// Function to trigger the animation and alert


	function showAlertOnClick() {   
	const bellIcon = document.getElementById('bellIcon');
	alert("What is up")
	
	  

	  // Remove the 'red-bell' class and add the 'green-bell' class
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.add('green-bell');
  
	  // Play the alert sound (replace with your own sound file)
	  const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
	  alertSound.play();
  
	  // Start the animation
	  bellIcon.classList.add('bell-icon-animation');


// Event listener for the bell icon click
		document.getElementById('bellIcon').addEventListener('click', () => {

		
	  // Reset the bell icon to its green state and stop the animation
	  const bellIcon = document.getElementById('bellIcon');
	  bellIcon.classList.remove('red-bell');
	  bellIcon.classList.remove('bell-icon-animation');
	  bellIcon.classList.remove('green-bell');
	  bellIcon.classList.add(' red-bell');
	
	});
	}

	eventSource.onmessage = (event) => {
	  console.log('Received data:', event.data); // Debugging line
  
	  // Trigger the animation and alert
	  triggerAnimationAndAlert();
  
	  // Display the flash notification when data is received
	  flashNotification.style.display = 'block';
  
	  // Hide the flash notification after a delay (e.g., 3 seconds)
	  setTimeout(() => {
		flashNotification.style.display = 'none';
	  }, 3000);
	//   notificationDropdown.innerHTML = '';
	  // Display the received data in the list
	  const newEntry = JSON.parse(event.data);
	  const listItem = document.createElement('li');
	  listItem.textContent = `Driver Name: ${newEntry.driver_name}, Passenger: ${newEntry.passenger}, Time Out: ${newEntry.time_out}`;
	  realtimeUpdatesList.appendChild(listItem);
  
	  // Create a new list item for the dropdown menu
	  const dropdownItem = document.createElement('a');
	  dropdownItem.classList.add('list-group-item', 'list-group-item-action');
	  dropdownItem.innerHTML = `
		<div class="row align-items-center">
		  <div class="col-auto">
			<img alt="Image placeholder" src="${newEntry.imageSrc || 'default-image.jpg'}" class="avatar rounded-circle">
		  </div>
		  <div class="col ml--2">
			<div class="d-flex justify-content-between align-items-center">
			  <div>
				<h4 class="mb-0 text-sm">${newEntry.driver_name|| 'Anonymous'}</h4>
			  </div>
			  <div class="text-right text-muted">
				<small>${newEntry.time_out}|| 'New Movement'}</small>
			  </div>
			</div>
		
		  </div>
		</div>
	  `;

	  // Add the new list item to the dropdown menu
	  notificationDropdown.appendChild(dropdownItem);
  
	  // Optionally, you can limit the number of notifications displayed by removing the oldest ones
	  const maxNotifications = 10; // Adjust this number as needed
	  if (notificationDropdown.children.length > maxNotifications) {
		notificationDropdown.removeChild(notificationDropdown.firstElementChild);
	  }
	

	const notificationCountElement = document.getElementById('notificationCount');
    // const notificationCount = notificationDropdown.children.length;
	const notificationCount = notificationDropdown.children.length - 3; // Subtract 3
    notificationCountElement.textContent = notificationCount;
	bellIcon.addEventListener('click', showAlertOnClick);
	};
})
  </script> -->

<!-- 
  <script>
	document.addEventListener('DOMContentLoaded', function () {
		const bellIcon = document.getElementById('bellIcon');
        // const flashNotification = document.getElementById('flash-notification');
        // const realtimeUpdatesList = document.getElementById('realtimeUpdates');
        // const eventSource = new EventSource('/events');
        // const notificationDropdown = document.getElementById('notificationDropdown');
        // Moved the bellIcon selection here

        // Function to trigger the animation and alert
        function showAlertOnClick() {
            alert("What is up");

            // Remove the 'red-bell' class and add the 'green-bell' class
            bellIcon.classList.remove('red-bell');
            bellIcon.classList.add('green-bell');

            // Play the alert sound (replace with your own sound file)
            const alertSound = new Audio('assets/sound/achive-sound-132273.mp3');
            alertSound.play();

            // Start the animation
            bellIcon.classList.add('bell-icon-animation');
        }

        // Event listener for the bell icon click
        bellIcon.addEventListener('click', () => {
            // Reset the bell icon to its green state and stop the animation
            bellIcon.classList.remove('red-bell');
            bellIcon.classList.remove('bell-icon-animation');
            bellIcon.classList.remove('green-bell');
            bellIcon.classList.add('red-bell');
        });

        eventSource.onmessage = (event) => {
            console.log('Received data:', event.data); // Debugging line

            // Trigger the showAlertOnClick function
            showAlertOnClick();

            // Display the flash notification when data is received
            flashNotification.style.display = 'block';

            // Hide the flash notification after a delay (e.g., 3 seconds)
            setTimeout(() => {
                flashNotification.style.display = 'none';
            }, 3000);

            // Display the received data in the list
            const newEntry = JSON.parse(event.data);
            const listItem = document.createElement('li');
            listItem.textContent = `Driver Name: ${newEntry.driver_name}, Passenger: ${newEntry.passenger}, Time Out: ${newEntry.time_out}`;
            realtimeUpdatesList.appendChild(listItem);

            // Create a new list item for the dropdown menu
            const dropdownItem = document.createElement('a');
            dropdownItem.classList.add('list-group-item', 'list-group-item-action');
            dropdownItem.innerHTML = `
                <div class="row align-items-center">
                    <div class="col-auto">
                        <img alt="Image placeholder" src="${newEntry.imageSrc || 'default-image.jpg'}" class="avatar rounded-circle">
                    </div>
                    <div class="col ml--2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="mb-0 text-sm">${newEntry.driver_name || 'Anonymous'}</h4>
                            </div>
                            <div class="text-right text-muted">
                                <small>${newEntry.time_out || 'New Movement'}</small>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Add the new list item to the dropdown menu
            notificationDropdown.appendChild(dropdownItem);

            // Optionally, you can limit the number of notifications displayed by removing the oldest ones
            const maxNotifications = 10; // Adjust this number as needed
            if (notificationDropdown.children.length > maxNotifications) {
                notificationDropdown.removeChild(notificationDropdown.firstElementChild);
            }

            const notificationCountElement = document.getElementById('notificationCount');
            const notificationCount = notificationDropdown.children.length - 3; // Subtract 3
            notificationCountElement.textContent = notificationCount;
        };
    });
</script> -->

<script>

    // Function to handle the Security Portal link click
  
document.getElementById('movementHistoryButton').addEventListener('click', () => {
        fetch('/get_movement_history')
            .then(response => response.json())
            .then(movementHistory => {
                // Populate the "Movement History" tab table
                const movementHistoryTableBody = document.getElementById('movementHistoryTableBody');
                movementHistoryTableBody.innerHTML = '';

                movementHistory.forEach(historyEntry => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${historyEntry.driver_name}</td>
                        <td>${historyEntry.armed_guard}</td>
                        <td>${historyEntry.time_out}</td>
                        <td>${historyEntry.time_in}</td>
                        <td>${historyEntry.target_location}</td>
                        <td>${historyEntry.passenger}</td>
                    `;
                    movementHistoryTableBody.appendChild(row);
                });

                // Now, show the desired tab
                showTab(3);
            })
            .catch(error => {
                console.error(error);
                // Handle error
            });
    });


   document.getElementById('fetchButton').addEventListener('click', () => {
        fetch('/get_movement_history')
            .then(response => response.json())
            .then(movementHistory => {
                // Do something with the movementHistory data
                console.log(movementHistory);
            })
            .catch(error => {
                console.error(error);
                // Handle error
            });
    });
					const tabs = document.querySelectorAll('.tab');
					const tabContents = document.querySelectorAll('.tab-content');

					tabs.forEach((tab, index) => {
						tab.addEventListener('click', () => {
							showTab(index);
						});
					});


			
function showFormPage() {
    // Redirect to the e-learning page
    // window.location.href = 'drivers_details2.html';
	window.location.href = 'hr_new_entry_page.html';
}

// Modify the showTab() function to hide previous tab's content and display new tab's content
function showTab(tabIndex) {




						tabContents.forEach(content => {
							content.style.display = 'none';
						});

						tabContents[tabIndex].style.display = 'block';

						if (tabIndex === 2) {
							// Fetch and populate the drivers details table
							fetch('/get_driver_details')
							// fetch('/get_driver_details')
								.then(response => response.json())
								.then(driverDetails => {
									const driverTableBody = document.getElementById('driverTableBody');
									driverTableBody.innerHTML = '';

									driverDetails.forEach(driver => {
										const row = document.createElement('tr');

										const timeOut = new Date(driver.time_out);
										const timeIn = new Date(driver.time_in);
										const formattedTimeOut = `${timeOut.getHours()}.${timeOut.getMinutes().toString().padStart(2, '0')}${timeOut.getHours() >= 12 ? 'pm' : 'am'} ${timeOut.getDate()}/${timeOut.getMonth() + 1}/${timeOut.getFullYear()}`;
										const formattedTimeIn = `${timeIn.getHours()}.${timeIn.getMinutes().toString().padStart(2, '0')}${timeIn.getHours() >= 12 ? 'pm' : 'am'} ${timeIn.getDate()}/${timeIn.getMonth() + 1}/${timeIn.getFullYear()}`;
		
										const rowHTML = `
							<td style="text-align: left;">${driver.driver_name}</td>
							<td style="text-align: left;">${driver.armed_guard}</td>
							<td style="text-align: left;">${formattedTimeOut}</td>
							<td style="text-align: left;">${formattedTimeIn}</td>
							<td style="text-align: left;">${driver.target_location}</td>
							<td style="text-align: left;">${driver.passenger}</td>

						<td style="text-align: left;">
    					<button class="preview-button" data-driver-id="123" onclick="previewGatePass('123')">Preview Gate Pass</button>
    					<button class="print-button" onclick="printGatePass('123')">Print Gate Pass</button>
						
						<button class="share-button" data-driver-id="123" onclick="authorizeDriver('123')">Authorize</button>
						</td> `;
										row.innerHTML = rowHTML;
										driverTableBody.appendChild(row);
									});
								})
								.catch(error => {
									console.error(error);
								});
						}

						tabContents[tabIndex].style.display = 'block';

						if (tabIndex === 1) { // Check if it's the "History" tab
							// Fetch and populate the visitor history table
							fetch('/get_visitor_history') // Replace with the appropriate endpoint
								.then(response => response.json())
								.then(visitorHistory => {
									const historyTableBody = document.getElementById('visitorTableBody2');
									historyTableBody.innerHTML = '';

									visitorHistory.forEach(visitor => {
										const row = document.createElement('tr');
										row.innerHTML = `
										<td>${visitor.name}</td>
										<td>${visitor.whomToSee}</td>
										<td>${visitor.address}</td>
										<td>${visitor.purposeOfVisit}</td>
										<td>${visitor.phoneNumber}</td>
										<td>${visitor.accessStatus}</td>
										<td>${visitor.date}</td>
									`;

										historyTableBody.appendChild(row);
									});
								})
								.catch(error => {
									console.error(error);
								});
						}

						if (tabIndex === 0) {
							// Fetch and populate the expected visitors table
							<!-- fetch('/get_expected_visitors') -->


								fetch('/get_new__visitor_details')
							
								.then(response => response.json())
								.then(expectedVisitors => {
									const visitorTableBody = document.getElementById('visitorTableBody1');
									visitorTableBody.innerHTML = '';

									expectedVisitors.forEach(visitor => {
										const row = document.createElement('tr');
										const currentDate = new Date().toLocaleDateString();
										const currentTime = new Date().toLocaleTimeString();
										const rowHTML = `
							<td>${visitor.name}</td>
							<td>${visitor.whomToSee}</td>
							<td>${visitor.address}</td>
							<td>${visitor.purposeOfVisit}</td>
							<td>${visitor.phoneNumber}</td>
							<td>${currentDate}</td>
							<td>${currentTime}</td>
							<td class="access-buttons">
							  <button class="grant-access" onclick="grantAccess('${visitor.name}', '${visitor.whomToSee}', '${visitor.address}', '${visitor.purposeOfVisit}', '${visitor.phoneNumber}')">
								Grant Access
							  </button>
							  <button class="deny-access" onclick="denyAccess('${visitor.name}', '${visitor.whomToSee}', '${visitor.address}', '${visitor.purposeOfVisit}', '${visitor.phoneNumber}')">
								Deny Access
							  </button>
							</td>
						  `;
										row.innerHTML = rowHTML;
										visitorTableBody.appendChild(row);
									});
								})
								.catch(error => {
									console.error(error);
								});
						}
					}



		if (tabIndex === 3) { // Check if it's the "Movement History" tab
        fetch('/get_movement_history') // Replace with the appropriate endpoint
            .then(response => response.json())
            .then(movementHistory => {
                const movementHistoryTableBody = document.getElementById('movementHistoryTableBody');
                movementHistoryTableBody.innerHTML = '';

                movementHistory.forEach(historyEntry => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${historyEntry.driver_name}</td>
                        <td>${historyEntry.armed_guard}</td>
                        <td>${historyEntry.time_out}</td>
                        <td>${historyEntry.time_in}</td>
                        <td>${historyEntry.target_location}</td>
                        <td>${historyEntry.passenger}</td>
                        <td>
                            <button class="preview-button" data-driver-id="${historyEntry.id}" onclick="previewGatePass('${historyEntry.id}')">Preview Gate Pass</button>
                            <button class="print-button" onclick="printGatePass('${historyEntry.id}')">Print Gate Pass</button>
                            <button class="share-button" data-driver-id="${historyEntry.id}" onclick="authorizeDriver('${historyEntry.id}')">Authorize</button>
                        </td>
                    `;
                    movementHistoryTableBody.appendChild(row);
                });
            })
            .catch(error => {
                console.error(error);
            });
    }
				
					function grantAccess(name, whomToSee, address, purposeOfVisit, phoneNumber) {
						alert("You are not authorized, kindly contact the security unit");
				// 		const currentDate = new Date().toLocaleDateString();
				// 		const currentTime = new Date().toLocaleTimeString();

				// 		const row = document.createElement('tr');
				// 		const formattedDate = `${currentDate}`;
				// 		const formattedTime = `${currentTime}`;

				// 		row.innerHTML = `
				// 	<td>${name}</td>
				// 	<td>${whomToSee}</td>
				// 	<td>${address}</td>
				// 	<td>${purposeOfVisit}</td>
				// 	<td>${phoneNumber}</td>
				// 	<td>${formattedDate}</td>
				// 	<td>${formattedTime}</td>
				// 	<td class="access-buttons">
				// 	  <button class="grant-access" onclick="grantAccess('${name}', '${whomToSee}', '${address}', '${purposeOfVisit}', '${phoneNumber}')">
				// 		Grant Access
				// 	  </button>
				// 	  <button class="deny-access" onclick="denyAccess('${name}', '${whomToSee}', '${address}', '${purposeOfVisit}', '${phoneNumber}')">
				// 		Deny Access
				// 	  </button>
				// 	</td>
				//   `;

				// 		const historyTableBody = document.getElementById('visitorTableBody2');
				// 		historyTableBody.appendChild(row);

				// 		// Remove the row from the visitor table
				// 		const grantAccessButtons = document.getElementsByClassName('grant-access');

				// 		for (let i = 0; i < grantAccessButtons.length; i++) {
				// 			if (grantAccessButtons[i].innerText === 'Grant Access' && grantAccessButtons[i].parentNode.parentNode.contains(event.target)) {
				// 				grantAccessButtons[i].parentNode.parentNode.remove();
				// 				break;
				// 			}
				// 		}

				// 		sendToMongoDB(name, whomToSee, address, purposeOfVisit, phoneNumber, 'Granted', currentDate, currentTime);
					}

					function denyAccess(name, whomToSee, address, purposeOfVisit, phoneNumber) {
						alert("You are not authorized, kindly contact the security unit");
				// 		const currentDate = new Date().toLocaleDateString();
				// 		const currentTime = new Date().toLocaleTimeString();

				// 		const row = document.createElement('tr');
				// 		const formattedDate = `${currentDate}`;
				// 		const formattedTime = `${currentTime}`;

				// 		row.innerHTML = `
				// 	<td>${name}</td>
				// 	<td>${whomToSee}</td>
				// 	<td>${address}</td>
				// 	<td>${purposeOfVisit}</td>
				// 	<td>${phoneNumber}</td>
				// 	<td>${formattedDate}</td>
				// 	<td>${formattedTime}</td>
				// 	<td class="access-buttons">
				// 	  <button class="grant-access" onclick="grantAccess('${name}', '${whomToSee}', '${address}', '${purposeOfVisit}', '${phoneNumber}')">
				// 		Grant Access
				// 	  </button>
				// 	  <button class="deny-access" onclick="denyAccess('${name}', '${whomToSee}', '${address}', '${purposeOfVisit}', '${phoneNumber}')">
				// 		Deny Access
				// 	  </button>
				// 	</td>
				//   `;

				// 		const historyTableBody = document.getElementById('visitorTableBody2');
				// 		historyTableBody.appendChild(row);

				// 		// Remove the row from the visitor table
				// 		const denyAccessButtons = document.getElementsByClassName('deny-access');

				// 		for (let i = 0; i < denyAccessButtons.length; i++) {
				// 			if (denyAccessButtons[i].innerText === 'Deny Access' && denyAccessButtons[i].parentNode.parentNode.contains(event.target)) {
				// 				denyAccessButtons[i].parentNode.parentNode.remove();
				// 				break;
				// 			}
				// 		}

				// 		// sendToMongoDB(name, whomToSee, address, purposeOfVisit, phoneNumber, 'Denied', currentDate, currentTime);
				// 		sendToMongoDB(name, whomToSee, address, purposeOfVisit, phoneNumber, 'Denied', currentDate, currentTime);
					}

					function sendToMongoDB(name, whomToSee, address, purposeOfVisit, phoneNumber, accessStatus, date, time) {
						const data = {
							name: name,
							whomToSee: whomToSee,
							address: address,
							purposeOfVisit: purposeOfVisit,
							phoneNumber: phoneNumber,
							accessStatus: accessStatus,
							date: date,
							time: time
						};

						fetch('/addVisitorHistory', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
							},
							body: JSON.stringify(data),
						})
							.then(response => response.json())
							.then(data => {
								console.log('Data added to history:', data);
								// You can perform additional actions if needed
							})
							.catch(error => {
								console.error('Error adding data to history:', error);
								// Handle error if necessary
							});



// Function to fetch total visitor count
async function fetchTotalVisitorCount() {
    try {
        const response = await fetch('/get_total_visitor_count');
        const totalCount = await response.json();
        document.getElementById('totalVisitorCount').textContent = totalCount;
    } catch (error) {
        console.error('Error fetching total visitor count:', error);
    }
}

// Function to fetch today's visitor count
async function fetchTodayVisitorCount() {
    try {
        const response = await fetch('/get_today_visitor_count');
        const todayCount = await response.json();
        document.getElementById('todayVisitorCount').textContent = todayCount;
    } catch (error) {
        console.error('Error fetching today\'s visitor count:', error);
    }
}

// Attach event listener to the button
const fetchCountsButton = document.getElementById('fetchCountsButton');
fetchCountsButton.addEventListener('click', () => {
    fetchTotalVisitorCount();
    fetchTodayVisitorCount();
});

}

function authorizeDriver(driverId) {
	console.log('Driver ID:', driverId);
  // Fetch the driver details from the "driverTableBody" using the driverId
  const driverTableBody = document.getElementById('driverTableBody');
  const driverRow = Array.from(driverTableBody.children).find(row => {
    const button = row.querySelector('.share-button');
    return button && button.dataset.driverId === driverId;
  });
//   console.log(driverTableBody);
// alert(driverTableBody)
  if (!driverRow) {
    console.error('Driver details not found.');
    return;
  }

  // Extract the data from the row
  const driverName = driverRow.querySelector('td:nth-child(1)').innerText;
  const armedGuard = driverRow.querySelector('td:nth-child(2)').innerText;
  const timeOut = driverRow.querySelector('td:nth-child(3)').innerText;
  const timeIn = driverRow.querySelector('td:nth-child(4)').innerText;
  const destination = driverRow.querySelector('td:nth-child(5)').innerText;
  const passenger = driverRow.querySelector('td:nth-child(6)').innerText;
//   alert(passenger)
  // Create the driver data object
  const driverData = {
    driver_name: driverName,
    armed_guard: armedGuard,
    target_location: destination,
    passenger: passenger,
    time_in: timeIn,
    time_out: timeOut,
  };

  // Log the extracted data to the browser console
  console.log('Driver Data:', driverData);

  // The rest of your code to send the driverData to the server...

  //Send the driver data to the server
  fetch('/movement_history', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(driverData),
  })
    .then(response => response.json())
    .then(data => {
      console.log(data); // Check the response from the server
    })
    .catch(error => {
      console.error('Error sending data:', error);

	});
  }

  // The rest of your code for sending data to the server...

  // Function to handle the "Preview Gate Pass" button click
  function previewGatePass(driverId) {
    // Perform preview operation
    fetch(`/getDriverDetails/${driverId}`)
      .then(response => response.json())
      .then(driverData => {
        // Send the driver data to the drivers' history database
        sendToDriversHistoryDB(driverData);

        // Update the state variable to indicate that the Preview Gate Pass button is clicked
        // (You can remove this if not needed)
        previewButtonClicked = true;
      })
      .catch(error => {
        console.error('Error fetching driver details:', error);
        // Handle error if necessary
      });
  }

  // Function to save the driver details to the "movementHistory" database
  function saveToMovementHistoryDB(driverData) {
    // Implement this function to send the driver data to the "movementHistory" database
    // Similar to the existing function sendToDriversHistoryDB()
  }

  // Function to remove the data of the row from the "movement_details" table
  function deleteRowFromMovementDB(driverId) {
    // Implement this function to remove the driver data from the "movement_details" table
    // Similar to the existing function deleteDriver()
  }

  // Function to fetch the ticket link from the "sw3" database using driverData
  function fetchTicketLink(driverData) {
    // Implement this function to fetch the ticket link from the "sw3" database
    // You can use the driverData to fetch the relevant ticket link
    // Return a Promise that resolves with the ticket link
  }

  document.addEventListener("DOMContentLoaded", async function () {
    const historyCountElement = document.getElementById('history-count');

    // Fetch the initial count from the server and update the placeholder
    const response = await fetch('/movement_history');
    const countString = await response.text();
    historyCountElement.textContent = countString;
  });

 // Define the function that fetches and updates visitor counts
 function fetchAndDisplayCounts() {
        fetch('/get_total_visitor_count')
            .then(response => response.json())
            .then(totalCount => {
                fetch('/get_today_visitor_count')
                    .then(response => response.json())
                    .then(todayCount => {
                        // Log the counts to the console
                        console.log('Total Count:', totalCount);
                        console.log('Today Count:', todayCount);

                        // Display alert with the counts
                        alert(`Today Count: ${todayCount}\nTotal Count: ${totalCount}`);
                        
                        const visitorCountsElement = document.getElementById('visitorCounts');
                        visitorCountsElement.textContent = `${todayCount}/${totalCount}`;
                    })
                    .catch(error => {
                        console.error(error);
                        // Handle error
                    });
            })
            .catch(error => {
                console.error(error);
                // Handle error
            });
    }

    // Attach the function to be triggered when the button is clicked
    document.getElementById('fetchButton').addEventListener('click', fetchAndDisplayCounts);
</script

	</footer>
</div>
</body>

</html>

